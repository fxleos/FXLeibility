legend("topleft",c("Price","Load"), fill = c(1,3))
plot(as.Date(df$datetime),P_o,type = "l",ylim = range(0:15000),col = "black",xlab = "Time [Year]", ylab = "Price [AUD/MWh]")
par(new = TRUE)
plot(L_o,type = "l",ylim = range(0:15000),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
axis(side=4,at = pretty(range(0:15000)))
legend("topleft",c("Price","Load"), fill = c(1,4))
#Original
plot(as.Date(df$datetime),P_o,type = "l",ylim = range(0:15000),col = "black",xlab = "Time [Year]", ylab = "Price [AUD/MWh]")
par(new = TRUE)
plot(L_o,type = "l",ylim = range(0:15000),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
axis(side=4,at = pretty(range(0:15000)))
legend("topright",c("Price","Load"), fill = c(1,4), cex = 0.7)
mtext("Load [MW]",side = 4)
#price
plot(as.Date(df$datetime),P_o,type = "l",ylim = range(-50:100),col = "black",xlab = "Time [Year]", ylab = "Price [AUD/MWh]")
par(new = TRUE)
plot(P_r,type = "l",ylim = range(-50:100),col = 2, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(P_f_d,type = "l",ylim = range(-50:100),col = 3, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(P_f_w,type = "l",ylim = range(-50:100),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(P_f_m,type = "l",ylim = range(-50:100),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(P_f_y,type = "l",ylim = range(-50:100),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("bottomright",c("Original","Regressed","Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = 1:6, cex = 0.7)
legend("bottomleft",c("Original","Regressed","Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = 1:6, cex = 0.7)
plot(as.Date(df$datetime),P_o,type = "l",ylim = range(-50:100),col = "black",xlab = "Time [Year]", ylab = "Price [AUD/MWh]")
par(new = TRUE)
plot(P_r,type = "l",ylim = range(-50:100),col = 2, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(P_f_d,type = "l",ylim = range(-50:100),col = 3, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(P_f_w,type = "l",ylim = range(-50:100),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(P_f_m,type = "l",ylim = range(-50:100),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(P_f_y,type = "l",ylim = range(-50:100),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("bottomright",c("Original","Regressed","Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = 1:6, cex = 0.7)
#load
plot(L_o,type = "l",ylim = range(0:20000),col = "black")
par(new = TRUE)
plot(L_r,type = "l",ylim = range(0:20000),col = 2, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_d,type = "l",ylim = range(0:20000),col = 3, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_w,type = "l",ylim = range(0:20000),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_m,type = "l",ylim = range(0:20000),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_y,type = "l",ylim = range(0:20000),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("topright",c("Original","Regressed","Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = 1:6, cex = 0.7)
legend("topright",c("Original","Regressed","Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = 1:6, cex = 0.5)
plot(L_o,type = "l",ylim = range(0:20000),col = "black")
par(new = TRUE)
plot(L_r,type = "l",ylim = range(0:20000),col = 2, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_d,type = "l",ylim = range(0:20000),col = 3, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_w,type = "l",ylim = range(0:20000),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_m,type = "l",ylim = range(0:20000),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_y,type = "l",ylim = range(0:20000),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("topright",c("Original","Regressed","Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = 1:6, cex = 0.5)
#load
plot(as.Date(df$datetime),L_o,type = "l",ylim = range(0:20000),col = "black")
par(new = TRUE)
plot(L_r,type = "l",ylim = range(0:20000),col = 2, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_d,type = "l",ylim = range(0:20000),col = 3, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_w,type = "l",ylim = range(0:20000),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_m,type = "l",ylim = range(0:20000),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_y,type = "l",ylim = range(0:20000),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("topright",c("Original","Regressed","Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = 1:6, cex = 0.5)
#load
plot(as.Date(df$datetime),L_o,type = "l",ylim = range(0:20000),col = "black",xlab = "Time [Year]", ylab = "Load [MW]")
par(new = TRUE)
plot(L_r,type = "l",ylim = range(0:20000),col = 2, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_d,type = "l",ylim = range(0:20000),col = 3, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_w,type = "l",ylim = range(0:20000),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_m,type = "l",ylim = range(0:20000),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_y,type = "l",ylim = range(0:20000),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("topright",c("Original","Regressed","Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = 1:6, cex = 0.5)
#load
plot(as.Date(df$datetime),L_o,type = "l",ylim = range(0:20000),col = "black",xlab = "Time [Year]", ylab = "Load [MW]")
par(new = TRUE)
plot(L_r,type = "l",ylim = range(0:20000),col = 2, axes=FALSE,bty="n",xlab="",ylab="")
#load
plot(as.Date(df$datetime),L_o,type = "l",ylim = range(0:20000),col = "black",xlab = "Time [Year]", ylab = "Load [MW]")
par(new = TRUE)
plot(L_f_d,type = "l",ylim = range(0:20000),col = 3, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_w,type = "l",ylim = range(0:20000),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_m,type = "l",ylim = range(0:20000),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(L_f_y,type = "l",ylim = range(0:20000),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("topright",c("Original","Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = c(1,3:6), cex = 0.5)
sum(P_r*L_o)
# Evolution yearly
cost_o = vector("numeric")
cost_o = vector("numeric")
cost_r = vector("numeric")
cost_y = vector("numeric")
cost_m = vector("numeric")
cost_w = vector("numeric")
cost_d = vector("numeric")
for (y in 1: 10){
cost_o = c(cost_o,sum(P_o[(yEnds[m-1]+1):yEnds[m]]*L_o[(yEnds[m-1]+1):yEnds[m]]))
cost_r = c(cost_r,sum(P_r[(yEnds[m-1]+1):yEnds[m]]*L_o[(yEnds[m-1]+1):yEnds[m]]))
cost_d = c(cost_d,sum(P_f_d[(yEnds[m-1]+1):yEnds[m]]*L_f_d[(yEnds[m-1]+1):yEnds[m]]))
cost_w = c(cost_w,sum(P_f_w[(yEnds[m-1]+1):yEnds[m]]*L_f_w[(yEnds[m-1]+1):yEnds[m]]))
cost_m = c(cost_m,sum(P_f_m[(yEnds[m-1]+1):yEnds[m]]*L_f_m[(yEnds[m-1]+1):yEnds[m]]))
cost_y = c(cost_oy,sum(P_f_y[(yEnds[m-1]+1):yEnds[m]]*L_f_y[(yEnds[m-1]+1):yEnds[m]]))
}
cost_o = vector("numeric")
cost_r = vector("numeric")
cost_y = vector("numeric")
cost_m = vector("numeric")
cost_w = vector("numeric")
cost_d = vector("numeric")
for (y in 1: 10){
cost_o = c(cost_o,sum(P_o[(yEnds[m-1]+1):yEnds[m]]*L_o[(yEnds[m-1]+1):yEnds[m]]))
cost_r = c(cost_r,sum(P_r[(yEnds[m-1]+1):yEnds[m]]*L_o[(yEnds[m-1]+1):yEnds[m]]))
cost_d = c(cost_d,sum(P_f_d[(yEnds[m-1]+1):yEnds[m]]*L_f_d[(yEnds[m-1]+1):yEnds[m]]))
cost_w = c(cost_w,sum(P_f_w[(yEnds[m-1]+1):yEnds[m]]*L_f_w[(yEnds[m-1]+1):yEnds[m]]))
cost_m = c(cost_m,sum(P_f_m[(yEnds[m-1]+1):yEnds[m]]*L_f_m[(yEnds[m-1]+1):yEnds[m]]))
cost_y = c(cost_y,sum(P_f_y[(yEnds[m-1]+1):yEnds[m]]*L_f_y[(yEnds[m-1]+1):yEnds[m]]))
}
cost_o
cost_o = vector("numeric")
cost_r = vector("numeric")
cost_y = vector("numeric")
cost_m = vector("numeric")
cost_w = vector("numeric")
cost_d = vector("numeric")
for (y in 1: 10){
cost_o = c(cost_o,sum(P_o[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]]))
cost_r = c(cost_r,sum(P_r[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]]))
cost_d = c(cost_d,sum(P_f_d[(yEnds[y-1]+1):yEnds[y]]*L_f_d[(yEnds[y-1]+1):yEnds[y]]))
cost_w = c(cost_w,sum(P_f_w[(yEnds[y-1]+1):yEnds[y]]*L_f_w[(yEnds[y-1]+1):yEnds[y]]))
cost_m = c(cost_m,sum(P_f_m[(yEnds[y-1]+1):yEnds[y]]*L_f_m[(yEnds[y-1]+1):yEnds[y]]))
cost_y = c(cost_y,sum(P_f_y[(yEnds[y-1]+1):yEnds[y]]*L_f_y[(yEnds[y-1]+1):yEnds[y]]))
}
cost_o = vector("numeric")
cost_r = vector("numeric")
cost_y = vector("numeric")
cost_m = vector("numeric")
cost_w = vector("numeric")
cost_d = vector("numeric")
for (y in 2: 11){
cost_o = c(cost_o,sum(P_o[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]]))
cost_r = c(cost_r,sum(P_r[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]]))
cost_d = c(cost_d,sum(P_f_d[(yEnds[y-1]+1):yEnds[y]]*L_f_d[(yEnds[y-1]+1):yEnds[y]]))
cost_w = c(cost_w,sum(P_f_w[(yEnds[y-1]+1):yEnds[y]]*L_f_w[(yEnds[y-1]+1):yEnds[y]]))
cost_m = c(cost_m,sum(P_f_m[(yEnds[y-1]+1):yEnds[y]]*L_f_m[(yEnds[y-1]+1):yEnds[y]]))
cost_y = c(cost_y,sum(P_f_y[(yEnds[y-1]+1):yEnds[y]]*L_f_y[(yEnds[y-1]+1):yEnds[y]]))
}
cost_o
plot(cost_o,type = "l")
plot(cost_r/cost_o,type = "l")
plot(cost_d/cost_o,type = "l")
plot(cost_d/cost_r,type = "l")
plot(cost_y/cost_r,type = "l")
plot(1-cost_y/cost_r,type = "l")
Years = 2007:2016
plot(Years,1- cost_d/cost_r,type = "l",ylim = range(0:1),col = "black",xlab = "Time [Year]", ylab = "Relative reduced cost")
par(new = TRUE)
Years = 2007:2016
plot(Years,1- cost_d/cost_r,type = "l",ylim = range(0:1),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
par(new = TRUE)
plot(Years,1- cost_w/cost_r,type = "l",ylim = range(0:1),col = 4,xlab = "Time [Year]", ylab = "Relative reduced cost")
par(new = TRUE)
plot(Years,1- cost_m/cost_r,type = "l",ylim = range(0:1),col = 5,xlab = "Time [Year]", ylab = "Relative reduced cost")
par(new = TRUE)
plot(Years,1- cost_y/cost_r,type = "l",ylim = range(0:1),col = 6,xlab = "Time [Year]", ylab = "Relative reduced cost")
plot(Years,1- cost_d/cost_r,type = "l",ylim = range(0:0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
par(new = TRUE)
plot(Years,1- cost_w/cost_r,type = "l",ylim = range(0:0.5),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,1- cost_m/cost_r,type = "l",ylim = range(0:0.5),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,1- cost_y/cost_r,type = "l",ylim = range(0:0.5),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,1- cost_d/cost_r,type = "l",ylim = range(0:0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
plot(Years,1- cost_d/cost_r,type = "l",ylim = range(0:0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
plot(Years,1- cost_d/cost_r,type = "l",ylim = range(0:1),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
plot(Years,1- cost_d/cost_r,type = "l",ylim = range(0:0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
plot(Years,1- cost_d/cost_r,type = "l",ylim = c(0:0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
plot(Years,1- cost_d/cost_r,type = "l",ylim = c(0,0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
plot(Years,1- cost_d/cost_r,type = "l",ylim = c(0,0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
par(new = TRUE)
plot(Years,1- cost_w/cost_r,type = "l",ylim = c(0,0.5),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,1- cost_m/cost_r,type = "l",ylim = c(0,0.5),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,1- cost_y/cost_r,type = "l",ylim = c(0,0.5),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
plot(Years,1- cost_d/cost_r,type = "l",ylim = c(-0.1,0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
plot(Years,1- cost_d/cost_r,type = "l",ylim = c(-0.05,0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
plot(Years,1- cost_d/cost_r,type = "l",ylim = c(-0.05,0.5),col = 3,xlab = "Time [Year]", ylab = "Relative reduced cost")
par(new = TRUE)
plot(Years,1- cost_w/cost_r,type = "l",ylim = c(-0.05,0.5),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,1- cost_m/cost_r,type = "l",ylim = c(-0.05,0.5),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,1- cost_y/cost_r,type = "l",ylim = c(-0.05,0.5),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
cost_r - cost_d
(cost_r - cost_d)/1000000000
barplot((cost_r - cost_d)/1000000000)
cbind((cost_r - cost_d)/1000000000,(cost_r - cost_w)/1000000000)
barplot(cbind((cost_r - cost_d)/1000000000,(cost_r - cost_w)/1000000000))
cbind(cost_o,cost_r,cost_d,cost_w,cost_m,cost_y)
towrite = cbind(cost_o,cost_r,cost_d,cost_w,cost_m,cost_y)
write.csv(towrite,"NSW_flexibilty_value_evoluation.csv")
y = 9
sum(P_o[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]]
)
sum(L_o[(yEnds[y-1]+1):yEnds[y]])
sum(L_f_d[(yEnds[y-1]+1):yEnds[y]])
sum(L_f_y[(yEnds[y-1]+1):yEnds[y]])
sum(P_f_y[(yEnds[y-1]+1):yEnds[y]])
sum(P_o[(yEnds[y-1]+1):yEnds[y]])
plot(P_o[(yEnds[y-1]+1):yEnds[y]],type ="l")
plot(P_o[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:200))
lines(P_f_d[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:200))
plot(P_o[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:200))
lines(P_f_d[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:200),col = "blue")
lines(P_f_y[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:200),col = 2)
plot(L_o[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:200))
plot(L_o[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:15000))
lines(L_o[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:15000),col = 2)
plot(L_o[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:15000))
lines(L_f_d[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:15000),col = 2)
lines(L_f_y[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:15000),col = 3)
plot(P_o[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:200))
par(new=TRUE)
plot(L_f_y[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:15000),col = 3,axes = FALSE)
lines(L_o[(yEnds[y-1]+1):yEnds[y]],type ="l", ylim = range(0:15000),col = 2,axes = FALSE)
Ra''
Ra[1]
Ra[1]*(L_o[1])^2+Rb[2]*L_o[1]
Ra[1]*(L_f_d[1])^2+Rb[2]*L_f_d[1]
c(1,1,1)*c(2,2,2)
(c(1,1,1)*c(2,2,2))^2
((Ra*L_f_d)^2/2+Rb*L_f_d) - ((Ra*L_o)^2/2+Rb*L_o)
sum(((Ra*L_f_d)^2/2+Rb*L_f_d) - ((Ra*L_o)^2/2+Rb*L_o))
sum(((Ra*L_f_d)^2/2+Rb*L_f_d) - ((Ra*L_o)^2/2+Rb*L_o))/sum(L_o*P_o)
sum(((Ra*L_f_y)^2/2+Rb*L_f_y) - ((Ra*L_o)^2/2+Rb*L_o))
sum(((Ra*L_f_y)^2/2+Rb*L_f_y) - ((Ra*L_o)^2/2+Rb*L_o))/sum(L_o*P_o)
revenue_y = vector("numeric")
revenue_m = vector("numeric")
revenue_w = vector("numeric")
revenue_d = vector("numeric")
for (y in 2: 11){
revenue_d = c(revenue_o, sum(((Ra[(yEnds[y-1]+1):yEnds[y]]*L_f_d[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_d[(yEnds[y-1]+1):yEnds[y]]) - ((Ra[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_w = c(revenue_o, sum(((Ra[(yEnds[y-1]+1):yEnds[y]]*L_f_w[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_w[(yEnds[y-1]+1):yEnds[y]]) - ((Ra[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_m = c(revenue_o, sum(((Ra[(yEnds[y-1]+1):yEnds[y]]*L_f_m[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_m[(yEnds[y-1]+1):yEnds[y]]) - ((Ra[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_y = c(revenue_o, sum(((Ra[(yEnds[y-1]+1):yEnds[y]]*L_f_y[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_y[(yEnds[y-1]+1):yEnds[y]]) - ((Ra[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
}
revenue_y = vector("numeric")
revenue_m = vector("numeric")
revenue_w = vector("numeric")
revenue_d = vector("numeric")
for (y in 2: 11){
revenue_d = c(revenue_d, sum(((Ra[(yEnds[y-1]+1):yEnds[y]]*L_f_d[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_d[(yEnds[y-1]+1):yEnds[y]]) - ((Ra[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_w = c(revenue_w, sum(((Ra[(yEnds[y-1]+1):yEnds[y]]*L_f_w[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_w[(yEnds[y-1]+1):yEnds[y]]) - ((Ra[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_m = c(revenue_m, sum(((Ra[(yEnds[y-1]+1):yEnds[y]]*L_f_m[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_m[(yEnds[y-1]+1):yEnds[y]]) - ((Ra[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_y = c(revenue_y, sum(((Ra[(yEnds[y-1]+1):yEnds[y]]*L_f_y[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_y[(yEnds[y-1]+1):yEnds[y]]) - ((Ra[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
}
revenue_y
barplot(revenue_y)
barplot(revenue_d)
barplot(revenue_w)
barplot(revenue_m)
barplot(revenue_y)
(Ra*L_f_d)^2/2+Rb*L_f_d) - ((Ra*L_o)^2/2+Rb*L_o))
(Ra*L_f_d)^2/2+Rb*L_f_d) - ((Ra*L_o)^2/2+Rb*L_o)
((Ra*L_f_d)^2/2+Rb*L_f_d) - ((Ra*L_o)^2/2+Rb*L_o)
plot(((Ra*L_f_d)^2/2+Rb*L_f_d) - ((Ra*L_o)^2/2+Rb*L_o))
plot(((Ra*L_f_d)^2/2+Rb*L_f_d) - ((Ra*L_o)^2/2+Rb*L_o),type = "l")
a = ((Ra*L_f_d)^2/2+Rb*L_f_d) - ((Ra*L_o)^2/2+Rb*L_o)
plot(a, type = "l")
which.max(a)
Ra[7335]
Rb[7335]
P_o[7335]
L_o[7335]
L_f_d[7335]
P_f_d[7335]
(Ra[7335]*L_f_d[7335])^2/2+Rb[7335]*L_f_d[7335]) - ((Ra[7335]*L_o[7335])^2/2+Rb[7335]*L_o[7335])
(Ra[7335]*L_f_d[7335])^2/2+Rb[7335]*L_f_d[7335]) - ((Ra[7335]*L_o[7335])^2/2+Rb[7335]*L_o[7335]
(Ra[7335]*L_f_d[7335])^2/2+Rb[7335]*L_f_d[7335] - ((Ra[7335]*L_o[7335])^2/2+Rb[7335]*L_o[7335]
Ra[7335]*L_f_d[7335])^2/2+Rb[7335]*L_f_d[7335] - ((Ra[7335]*L_o[7335])^2/2+Rb[7335]*L_o[7335]
(Ra[7335]*L_f_d[7335])^2/2+Rb[7335]*L_f_d[7335] - (Ra[7335]*L_o[7335])^2/2+Rb[7335]*L_o[7335]
revenue_y = vector("numeric")
revenue_m = vector("numeric")
revenue_w = vector("numeric")
revenue_d = vector("numeric")
for (y in 2: 11){
revenue_d = c(revenue_d, sum((Ra[(yEnds[y-1]+1):yEnds[y]]*(L_f_d[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_d[(yEnds[y-1]+1):yEnds[y]]) - (Ra[(yEnds[y-1]+1):yEnds[y]]*(L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_w = c(revenue_w, sum((Ra[(yEnds[y-1]+1):yEnds[y]]*(L_f_w[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_w[(yEnds[y-1]+1):yEnds[y]]) - (Ra[(yEnds[y-1]+1):yEnds[y]]*(L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_m = c(revenue_m, sum((Ra[(yEnds[y-1]+1):yEnds[y]]*(L_f_m[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_m[(yEnds[y-1]+1):yEnds[y]]) - (Ra[(yEnds[y-1]+1):yEnds[y]]*(L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_y = c(revenue_y, sum((Ra[(yEnds[y-1]+1):yEnds[y]]*(L_f_y[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_y[(yEnds[y-1]+1):yEnds[y]]) - (Ra[(yEnds[y-1]+1):yEnds[y]]*(L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
}
barplot(revenue_d)
revenue_y = vector("numeric")
revenue_m = vector("numeric")
revenue_w = vector("numeric")
revenue_d = vector("numeric")
for (y in 2: 11){
revenue_d = c(revenue_d, -sum((Ra[(yEnds[y-1]+1):yEnds[y]]*(L_f_d[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_d[(yEnds[y-1]+1):yEnds[y]]) - (Ra[(yEnds[y-1]+1):yEnds[y]]*(L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_w = c(revenue_w, -sum((Ra[(yEnds[y-1]+1):yEnds[y]]*(L_f_w[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_w[(yEnds[y-1]+1):yEnds[y]]) - (Ra[(yEnds[y-1]+1):yEnds[y]]*(L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_m = c(revenue_m, -sum((Ra[(yEnds[y-1]+1):yEnds[y]]*(L_f_m[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_m[(yEnds[y-1]+1):yEnds[y]]) - (Ra[(yEnds[y-1]+1):yEnds[y]]*(L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
revenue_y = c(revenue_y, -sum((Ra[(yEnds[y-1]+1):yEnds[y]]*(L_f_y[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_f_y[(yEnds[y-1]+1):yEnds[y]]) - (Ra[(yEnds[y-1]+1):yEnds[y]]*(L_o[(yEnds[y-1]+1):yEnds[y]])^2/2+Rb[(yEnds[y-1]+1):yEnds[y]]*L_o[(yEnds[y-1]+1):yEnds[y]])))
}
barplot(revenue_d)
barplot(revenue_y)
sum(revenue_d)
sum(revenue_y)
a = c (sum(revenue_d),sum(revenue_w),sum(revenue_m),sum(revenue_y))
barplot(a)
a
sum(revenue_d)/sum(P_o*L_o)
sum(P_o*L_o)
par(new = TRUE)
plot(c(0.1,0.1,0.1,0.1),type = "l")
barplot(a)
lines(a/73252166078))
lines(a/73252166078)
a/73252166078
barplot(revenue_d)
barplot(revenue_d,names.arg = 2007:2016, ylab = "Revenue", col = "grey", main = "Total Revenue with Daily Flexibility",cex.names = 0.4,cex.axis = 0.5)))
barplot(revenue_d,names.arg = 2007:2016, ylab = "Revenue", col = "grey", main = "Total Revenue with Daily Flexibility",cex.names = 0.4,cex.axis = 0.5))
barplot(revenue_d,names.arg = 2007:2016, ylab = "Revenue", col = "grey", main = "Total Revenue with Daily Flexibility",cex.names = 0.4,cex.axis = 0.5)
plot(revenue_d,names.arg = 2007:2016, ylab = "Revenue", col = "grey", main = "Total Revenue with Daily Flexibility",cex.names = 0.4,cex.axis = 0.5)
plot(revenue_d,names.arg = 2007:2016, ylab = "Revenue", col = "grey", main = "Total Revenue with Daily Flexibility",cex.names = 0.4,cex.axis = 0.5, type = "l")
plot(revenue_d,names.arg = 2007:2016, ylab = "Revenue", col = 3, main = "Total Revenue with Daily Flexibility",cex.names = 0.4,cex.axis = 0.5, type = "l")
density(c_d)
d = density(c_d)
plot(d)
d = density(c_w)
plot(d)
plot(c_d)
plot(c_d,type = "l")
plot(rate_d,type = "l")
plot(rate_d[1:100],type = "l")
plot(rate_d[1:48],type = "l")
hist(rate_d[1:48],type = "l")
hist(rate_m[1:48],type = "l")
hist(rate_y,type = "l")
hist(c_y,type = "l")
hist(c_d,type = "l")
h = hist(c_d,type = "l")
method(h)
method(hist)
methods(hist)
plot(P_o[1:48])
plot(P_o[1:48],type = "l")
plot(L_o[1:48],type = "l",col = 2)
plot(P_o[1:48],type = "l")
par(new = TRUE)
plot(L_o[1:48],type = "l")
plot(L_f_d[1:48],type = "l",col = 2)
plot(P_o[1:48],type = "l")
par(new = TRUE)
plot(L_o[1:48],type = "l")
par(new = TRUE)
plot(L_f_d[1:48],type = "l",col = 2)
par(new = TRUE)
plot(P_f_d[1:48],type = "l",col = 2)
plot(P_o[1:48],type = "l")
par(new = TRUE)
plot(P_o[1:48],type = "l")
plot(P_o[1:47],type = "l")
par(new = TRUE)
plot(P_f_d[1:47],type = "l",col = 2)
plot(P_o[1:47],type = "l")
lines(P_f_d[1:47],type = "l",col = 2)
plot(P_o[1:47],type = "l")
par(new = TRUE)
plot(P_o[1:47],type = "l")
plot(P_o[1:47],type = "l",ylim = c(0,10))
plot(P_o[1:47],type = "l",ylim = c(10,20))
par(new = TRUE)
plot(P_f_d[1:47],type = "l",ylim = c(0,10),col = 2)
plot(P_o[1:47],type = "l",ylim = c(10,20))
plot(P_f_d[1:47],type = "l",ylim = c(10,20),col = 2)
plot(P_o[1:47],type = "l",ylim = c(10,20))
plot(P_o[1:47],type = "l",ylim = c(0,20))
par(new = TRUE)
plot(P_f_d[1:47],type = "l",ylim = c(0,20),col = 2)
par(new = TRUE)
plot(L_o[1:47],type = "l",col = 2)
par(new = TRUE)
plot(L_f_d[1:47],type = "l",col = 3)
plot(L_o[1:47],type = "l",col = 2)
lines(L_f_d[1:47],type = "l",col = 3)
par(new = TRUE)
plot(P_o[1:47],type = "l",ylim = c(0,20))
plot(L_o[48:95],type = "l",col = 2)
lines(L_f_d[48:95],type = "l",col = 3)
par(new = TRUE)
plot(P_o[48:95],type = "l"
)
plot(L_o[4848:4895],type = "l",col = 2)
lines(L_f_d[4848:4895],type = "l",col = 3)
par(new = TRUE)
plot(P_o[4848:4895],type = "l")
lines(L_f_w[4848:4895],type = "l",col = 3)
par(new = TRUE)
plot(L_f_w[4848:4895],type = "l",col = 3)
plot(revenue_d,type = "l")
plot(p_f_d*l_f_d/P_o*L_o,type = "l")
plot(P_f_d*L_f_d/P_o*L_o,type = "l")
cost_d
summary(cost_d)
sumcost_d)
sum(cost_d)
sum(cost_o)
sum(cost_r)
sum(cost_d)
sum(cost_w)
sum(cost_m)
sum(cost_y)
sum(cost_o)-sum(cost_d)
sum(revenue_d)/(sum(cost_o)-sum(cost_d))
(sum(cost_o)-sum(cost_d))/sum(revenue_d)
(sum(cost_o)-sum(cost_y))/sum(revenue_y)
(sum(cost_o)-sum(cost_m))/sum(revenue_m)
(sum(cost_o)-sum(cost_w))/sum(revenue_w)
plot(revenue_d,type = "l")
plot(revenue_d,type = "l",ylim = c(0,1000000000))
plot(revenue_d,type = "l",ylim = c(0,500000000))
plot(revenue_y,type = "l",ylim = c(0,500000000))
plot(revenue_y,type = "l",ylim = c(0,600000000))
plot(as.Date(df$datetime),revenue_y,type = "l",ylim = c(0,600000000))
plot(Years,revenue_y,type = "l",ylim = c(0,600000000))
plot(Years,revenue_d,type = "l",ylim = c(0,600000000))
plot(Years,revenue_d/1000000000,type = "l",ylim = c(0,600000000),col = 3,xlab = "Time [Year]", ylab = "Revenue of Arbitrage [billion AUD]")
plot(Years,revenue_d/1000000000,type = "l",ylim = c(0,0.6),col = 3,xlab = "Time [Year]", ylab = "Revenue of Arbitrage [billion AUD]")
plot(Years,revenue_d/1000000000,type = "l",ylim = c(0,600),col = 3,xlab = "Time [Year]", ylab = "Revenue of Arbitrage [million AUD]")
plot(Years,revenue_d/1000000,type = "l",ylim = c(0,600),col = 3,xlab = "Time [Year]", ylab = "Revenue of Arbitrage [million AUD]")
plot(Years,revenue_w/1000000,type = "l",ylim = c(-0.05,0.5),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,revenue_m/1000000,type = "l",ylim = c(-0.05,0.5),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,revenue_y/1000000,type = "l",ylim = c(-0.05,0.5),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("topright",c("Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = c(3:6), cex = 0.5)
plot(Years,revenue_d/1000000,type = "l",ylim = c(0,600),col = 3,xlab = "Time [Year]", ylab = "Revenue of Arbitrage [million AUD]")
par(new = TRUE)
plot(Years,revenue_w/1000000,type = "l",ylim = c(-0.05,0.5),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,revenue_m/1000000,type = "l",ylim = c(-0.05,0.5),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,revenue_y/1000000,type = "l",ylim = c(-0.05,0.5),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("topright",c("Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = c(3:6), cex = 0.5)
plot(Years,revenue_w/1000000,type = "l",ylim = c(-0.05,0.5),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
plot(Years,revenue_d/1000000,type = "l",ylim = c(0,600),col = 3,xlab = "Time [Year]", ylab = "Revenue of Arbitrage [million AUD]")
par(new = TRUE)
plot(Years,revenue_w/1000000,type = "l",ylim = c(0,600),col = 4, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,revenue_m/1000000,type = "l",ylim = c(0,600),col = 5, axes=FALSE,bty="n",xlab="",ylab="")
par(new = TRUE)
plot(Years,revenue_y/1000000,type = "l",ylim = c(0,600),col = 6, axes=FALSE,bty="n",xlab="",ylab="")
legend("topright",c("Flexibile-Day","Flexibile-Week","Flexibile-Month","Flexibile-Year"), fill = c(3:6), cex = 0.5)
index
P_o_m
lm(P_o_m[index]~L_o_m[index])
y = P_o_m[index]
x = L_o_m[index]
test = nls((exp((x-a)/b)-exp((c-x)/d))/2+e)
test = nls(y~(exp((x-a)/b)-exp((c-x)/d))/2+e)
a = numeric(length(x))
b = numeric(length(x))
c = numeric(length(x))
d = numeric(length(x))
a = 1
b = 1
c = 1
d = 1
e = 1
test = nls(y~(exp((x-a)/b)-exp((c-x)/d))/2+e)
test = nls(y~(exp((x-a)/b)-exp((c-x)/d))/2+e)
nls(y~a*x/(b+x))
test = nls(y~(exp((x-a)/b)-exp((c-x)/d))/2+e,
data = DNase1,
start = list(xmid = 0, scal = 1),
algorithm = "plinear")
test = nls(y~(exp((x-a)/b)-exp((c-x)/d))/2+e,
start = list(xmid = 0, scal = 1),
algorithm = "plinear")
test = nls(y~(exp((x-a)/b)-exp((c-x)/d))/2+e,algorithm = "plinear")
test = nls(y~(exp((x-a)/b)-exp((c-x)/d))/2+e)
install.packages('/Library/gurobi752/mac64/R/gurobi_7.5-2.tgz', repos=NULL)
library('gurobi')
install.packages('/Library/gurobi752/mac64/R/gurobi_7.5-2.tgz', repos=NULL)
library('gurobi')
library("slam")
install.packages("slam")
library("slam")
library('gurobi')
R.versioin()
R.Versioin()
R.Version()
